    <div class="container">
      <header class="app-header">
        <div class="app-header-left">
          <div class="app-header-brand-icon">
            <i class="fas fa-rocket"></i>
          </div>
          <span class="app-header-brand">TechTool</span>
        </div>
        <div class="app-header-right">
          <button
            id="shortcut-trigger"
            type="button"
            class="shortcut-button"
            title="Keyboard shortcuts"
            aria-haspopup="dialog"
            aria-controls="shortcut-overlay"
          >
            <i class="fas fa-keyboard"></i>
          </button>
          <div class="theme-toggle">
            <input type="checkbox" id="mode-toggle" aria-label="Toggle dark mode" />
            <label for="mode-toggle" class="theme-toggle-track">
              <i class="fas fa-sun theme-icon sun" aria-hidden="true"></i>
              <span class="theme-toggle-thumb"></span>
              <i class="fas fa-moon theme-icon moon" aria-hidden="true"></i>
            </label>
          </div>
        </div>
      </header>
      <div class="app-body">
        <aside class="sidebar">
          <div class="nav-panel">
            <button id="nav-home" class="nav-btn">
              <i class="fas fa-home"></i>
              <span>Dashboard</span>
            </button>
            <button id="nav-projects" class="nav-btn">
              <i class="fas fa-folder"></i>
              <span>Projects</span>
            </button>
            <button id="nav-all" class="nav-btn">
              <i class="fas fa-list-ul"></i>
              <span>All Tickets</span>
              <span
                id="all-tickets-count"
                class="nav-badge"
                style="display: none"
              ></span>
            </button>
            <button id="nav-my-ticket" class="nav-btn">
              <i class="fas fa-user"></i>
              <span>My Tickets</span>
              <span
                id="my-ticket-count"
                class="nav-badge"
                style="display: none"
              ></span>
            </button>
            <button id="nav-critical" class="nav-btn">
              <i class="fas fa-exclamation-circle"></i>
              <span>Critical</span>
              <span
                id="critical-count"
                class="nav-badge"
                style="display: none"
              ></span>
            </button>
            <button id="nav-stalled" class="nav-btn">
              <i class="fas fa-pause-circle"></i>
              <span>Stalled</span>
              <span
                id="stalled-count"
                class="nav-badge"
                style="display: none"
              ></span>
            </button>
            <button id="nav-unassigned" class="nav-btn">
              <i class="fas fa-inbox"></i>
              <span>Unassigned</span>
              <span
                id="unassigned-count"
                class="nav-badge"
                style="display: none"
              ></span>
            </button>
            <button id="nav-incomplete" class="nav-btn">
              <i class="fas fa-exclamation-triangle"></i>
              <span>Incomplete</span>
              <span
                id="incomplete-count"
                class="nav-badge"
                style="display: none"
              ></span>
            </button>
            <button id="nav-reconcile" class="nav-btn">
              <i class="far fa-clock"></i>
              <span>Reconcile Hours</span>
            </button>
          </div>
          <div class="sidebar-user-profile">
            <button
              id="sidebar-user-trigger"
              class="sidebar-user-trigger"
              type="button"
              aria-haspopup="true"
              aria-expanded="false"
            >
              <div class="sidebar-user">
                <div class="avatar" id="user-avatar"></div>
                <div class="details">
                  <div class="name">{{NAME}}</div>
                  <div class="role">{{ROLE}}</div>
                </div>
              </div>
              <i class="fas fa-chevron-down sidebar-user-trigger-icon"></i>
            </button>
            <div
              id="sidebar-user-menu"
              class="sidebar-user-menu"
              role="menu"
              aria-hidden="true"
            > 
              <button type="button" class="sidebar-user-menu-item" data-action="settings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
              </button>
              <button
                type="button"
                class="sidebar-user-menu-item logout-button"
                data-action="logout"
              >
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
              </button>
            </div>
          </div>
          <div
            id="version-banner"
            class="version-banner sidebar-version"
            role="status"
            aria-live="polite"
            data-state="current"
          >
            <i class="fas fa-info-circle version-banner-icon" aria-hidden="true"></i>
            <div class="version-banner-text">
              <span id="version-status-text">Version {{APP_VERSION_SHORT}}</span>
              <span id="version-stale-badge" class="version-stale-badge" hidden>Update available</span>
            </div>
            <button
              id="version-refresh-btn"
              type="button"
              class="version-refresh-btn"
              aria-label="Refresh to latest version"
              hidden
            >
              <i class="fas fa-sync-alt version-refresh-icon" aria-hidden="true"></i>
              <span class="version-refresh-label">Refresh</span>
            </button>
          </div>
        </aside>
        <div class="main-content-wrapper">
          <main>
          <div id="dashboard-view-wrapper" style="display: none">
            <!-- Modern Dashboard Header -->
            <div class="dashboard-header-modern">
              <div class="header-content">
                <div class="header-text">
                  <h1 class="dashboard-title-modern">Analytics Dashboard</h1>
                  <p class="dashboard-subtitle-modern">Real-time insights and performance metrics</p>
                </div>
                <div class="header-filters-modern">
                  <div class="filter-group-modern">
                    <label for="dashboard-assignee-filter">Team</label>
                    <select id="dashboard-assignee-filter" class="filter-select-modern">
                      <option value="all">All Members</option>
                    </select>
                  </div>
                  <div class="filter-group-modern">
                    <label for="dashboard-start-date">From</label>
                    <input type="date" id="dashboard-start-date" class="filter-input-modern" />
                  </div>
                  <div class="filter-group-modern">
                    <label for="dashboard-end-date">To</label>
                    <input type="date" id="dashboard-end-date" class="filter-input-modern" />
                  </div>
                  <button class="refresh-btn" onclick="renderDashboard()">
                    <i class="fas fa-sync-alt"></i>
                  </button>
                </div>
              </div>
            </div>


            <!-- Enhanced Metrics Grid -->
            <div class="metrics-grid-modern">
              <div class="metric-card-modern primary-gradient">
                <div class="metric-header">
                  <div class="metric-icon-modern">
                    <i class="fas fa-chart-line"></i>
                  </div>
                  <div class="metric-trend positive" id="tickets-trend">
                    <i class="fas fa-arrow-up"></i>
                    <span id="tickets-change">+12%</span>
                  </div>
                </div>
                <div class="metric-content-modern">
                  <div class="metric-value-modern" id="total-tickets-count">0</div>
                  <div class="metric-label-modern">Total Tickets</div>
                  <div class="metric-description">All time tickets created</div>
                </div>
                <div class="metric-chart-mini" id="total-chart-mini"></div>
              </div>
              
              <div class="metric-card-modern success-gradient">
                <div class="metric-header">
                  <div class="metric-icon-modern">
                    <i class="fas fa-check-circle"></i>
                  </div>
                  <div class="metric-trend positive" id="completed-trend">
                    <i class="fas fa-arrow-up"></i>
                    <span id="completed-change">+8%</span>
                  </div>
                </div>
                <div class="metric-content-modern">
                  <div class="metric-value-modern" id="completed-tickets-count">0</div>
                  <div class="metric-label-modern">Completed</div>
                  <div class="metric-description">Successfully resolved</div>
                </div>
                <div class="metric-chart-mini" id="completed-chart-mini"></div>
              </div>
              
              <div class="metric-card-modern warning-gradient">
                <div class="metric-header">
                  <div class="metric-icon-modern">
                    <i class="fas fa-clock"></i>
                  </div>
                  <div class="metric-trend positive" id="progress-trend">
                    <i class="fas fa-arrow-up"></i>
                    <span id="progress-change">+5%</span>
                  </div>
                </div>
                <div class="metric-content-modern">
                  <div class="metric-value-modern" id="in-progress-count">0</div>
                  <div class="metric-label-modern">In Progress</div>
                  <div class="metric-description">Currently being worked on</div>
                </div>
                <div class="metric-chart-mini" id="progress-chart-mini"></div>
              </div>
              
              <div class="metric-card-modern danger-gradient">
                <div class="metric-header">
                  <div class="metric-icon-modern">
                    <i class="fas fa-exclamation-triangle"></i>
                  </div>
                  <div class="metric-trend negative" id="blocked-trend">
                    <i class="fas fa-arrow-down"></i>
                    <span id="blocked-change">-3%</span>
                  </div>
                </div>
                <div class="metric-content-modern">
                  <div class="metric-value-modern" id="blocked-count">0</div>
                  <div class="metric-label-modern">Blocked</div>
                  <div class="metric-description">Requiring attention</div>
                </div>
                <div class="metric-chart-mini" id="blocked-chart-mini"></div>
              </div>
            </div>

            <!-- Advanced Analytics Section -->
            <div class="analytics-section">
              <div class="chart-container-modern">
                <div class="chart-header-modern">
                  <div class="chart-title-section">
                    <h3>Performance Trends</h3>
                    <p>Ticket creation and completion over time</p>
                  </div>
                </div>
                <div class="chart-wrapper">
                  <canvas id="trends-chart"></canvas>
                </div>
                
                <!-- Extended Chart Metrics -->
                <div class="chart-metrics-section">
                  <div class="chart-metrics-grid">
                    <div class="chart-metric-item">
                      <div class="metric-label">Peak Week</div>
                      <div class="metric-value" id="peak-week">Week 36</div>
                    </div>
                    <div class="chart-metric-item">
                      <div class="metric-label">Avg Created/Day</div>
                      <div class="metric-value" id="avg-created-per-day">3.2</div>
                    </div>
                    <div class="chart-metric-item">
                      <div class="metric-label">Avg Completed/Day</div>
                      <div class="metric-value" id="avg-completed-per-day">2.8</div>
                    </div>
                    <div class="chart-metric-item">
                      <div class="metric-label">Backlog Trend</div>
                      <div class="metric-value" id="backlog-trend">+12%</div>
                    </div>
                    <div class="chart-metric-item">
                      <div class="metric-label">Velocity Score</div>
                      <div class="metric-value" id="velocity-score">High</div>
                    </div>
                  </div>
                </div>
                </div>
              
              <div class="insights-panel">
                <div class="insight-card">
                  <div class="insight-header">
                    <h4>Priority Distribution</h4>
                    <div class="insight-value" id="priority-insight">Medium Heavy</div>
                </div>
                  <div class="priority-chart-modern">
                    <canvas id="priority-chart"></canvas>
              </div>
                  <div class="priority-legend-modern" id="priority-legend"></div>
            </div>

                <div class="insight-card">
                  <div class="insight-header">
                    <h4>Velocity Metrics</h4>
                    <div class="insight-value" id="velocity-insight">High</div>
              </div>
                  <div class="velocity-metrics">
                    <div class="velocity-item">
                      <span class="velocity-label">Avg. Response</span>
                      <span class="velocity-value" id="avg-response-time">0d</span>
                    </div>
                    <div class="velocity-item">
                      <span class="velocity-label">Avg. Resolution</span>
                      <span class="velocity-value" id="avg-resolution-time">0d</span>
                    </div>
                    <div class="velocity-item">
                      <span class="velocity-label">Completion Rate</span>
                      <span class="velocity-value" id="completion-rate">0%</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>


          </div>
          <div
            id="reconcile-filters"
            class="filter-panel"
            style="display: none"
          >
            <div
              id="reconcile-user-filter-container"
              class="filter-item"
              style="display: none"
            >
              <label for="reconcile-user-select"
                ><i class="fas fa-user-friends"></i> Team Member</label
              >
              <select
                id="reconcile-user-select"
                class="inline-editor"
              ></select>
            </div>
            <div class="filter-item">
              <label>
                <input
                  type="checkbox"
                  id="reconcile-exclude-done"
                  checked
                />
                Exclude Done
              </label>
            </div>
          </div>

          <div
            id="task-detail-modal"
            class="modal-overlay"
            style="display: none"
          >
            <div class="modal-content">
              <button class="close-button modal-close-btn">&times;</button>
              <div id="task-detail-modal-body" class="modal-body"></div>
            </div>
          </div>

          <div
            id="bulk-actions-panel"
            class="bulk-actions-panel"
            style="display: none"
          >
            <span id="selection-count">0 selected</span>
            <button id="assign-selected-btn" class="action-btn" disabled>
              Assign
            </button>
            <button id="update-selected-btn" class="action-btn" disabled>
              Update
            </button>
            <button id="cancel-bulk-edit-btn" class="cancel-btn">Cancel</button>
          </div>

          <div id="loader" class="loader-container">
            <div class="loader-body" role="status" aria-live="polite">
              <div class="loader-indicator"></div>
              <p>Loading workspace...</p>
            </div>
          </div>
          <div id="error-message" class="error-container" style="display: none">
            <p>Could not load data. Please try again later.</p>
          </div>

          <div class="table-wrapper" style="display: none">
            
            <!-- Clean Integrated Controls -->
            <div id="integrated-filters" class="clean-controls-panel">
              <div class="controls-header">
                <div class="filters-section">
                  <select id="project-filter-select" class="compact-select">
                    <option>All Projects</option>
                  </select>
                  <select id="epic-filter-select" class="compact-select">
                    <option>All Epics</option>
                  </select>
                  <select id="status-filter-select" class="compact-select">
                    <option>All Statuses</option>
                  </select>
                  <select id="assignee-filter-select" class="compact-select" style="display: none;">
                    <option>All Assignees</option>
                  </select>
                  <label class="checkbox-label">
                    <input type="checkbox" id="exclude-done-checkbox" checked />
                    Exclude Done
                  </label>
                </div>
                
                <div class="search-section">
                  <div class="search-input">
                    <i class="fas fa-hashtag"></i>
                    <input type="number" id="ticket-number-filter" placeholder="Ticket #" />
                  </div>
                  <div class="search-input">
                    <i class="fas fa-search"></i>
                    <input type="text" id="task-search-input" placeholder="Search..." />
                  </div>
                </div>
                
                <div class="action-section">
                  <button id="quick-add-btn" class="compact-btn" title="Quick Add (Alt+A or Cmd+A)" aria-label="Quick Add (Alt+A or Cmd+A)">
                    <i class="fas fa-plus"></i>
                  </button>
                  <button id="bulk-edit-btn" class="compact-btn" title="Bulk Edit">
                    <i class="fas fa-layer-group"></i>
                  </button>
                  <button
                    id="clear-url-filter-btn"
                    style="display: none"
                  >
                    <i class="fas fa-times"></i>
                    <span>Clear Search</span>
                  </button>
                </div>
              </div>
            </div>
            
            <table>
              <thead>
                <tr></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <!-- Simple Incomplete Table -->
          <div id="simple-incomplete-wrapper" style="display: none;">
            <div class="simple-header">
              <h2>Incomplete Tickets</h2>
              <span id="simple-incomplete-count">0 tickets</span>
            </div>
            
            <div class="simple-filter">
              <label>Member:</label>
              <select id="simple-member-filter">
                <option value="all">All Members</option>
              </select>
            </div>
            
            <div class="simple-table-container">
              <table id="simple-incomplete-table">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Task</th>
                    <th>Created</th>
                    <th>Assigned</th>
                    <th>Started</th>
                    <th>Completed</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>

          <div
            id="reconcile-view-wrapper"
            class="table-wrapper"
            style="display: none"
          >
            <div
              id="reconcile-pagination-controls"
              class="pagination-controls"
              style="display: none"
            >
              <span
                id="reconcile-total-count"
                class="page-info"
                style="margin-right: auto"
              ></span>
              <button id="reconcile-prev-page">&laquo; Previous</button>
              <span id="reconcile-page-info" class="page-info"></span>
              <button id="reconcile-next-page">Next &raquo;</button>
            </div>
          </div>

          <!-- Projects View -->
          <div id="projects-view-wrapper" class="finder-browser" style="display: none">
            <div class="finder-browser__body">
              <nav class="finder-breadcrumb" id="finder-breadcrumb" aria-label="Project navigation">
                <div class="finder-breadcrumb-trail" id="finder-breadcrumb-trail"></div>
                <div class="finder-breadcrumb-actions">
                  <button id="add-project-btn" class="finder-action-btn" title="Add project">
                    <i class="fas fa-plus"></i>
                  </button>
                </div>
              </nav>
              <div class="finder-columns-viewport">
                <div class="finder-columns finder-columns--static" id="finder-columns">
                  <section class="finder-column" data-level="project" aria-label="Projects">
                    <header class="finder-column-header">
                      <span class="finder-column-title">Projects</span>
                      <span class="finder-column-meta" id="finder-project-count"></span>
                    </header>
                    <div class="finder-column-body" id="finder-column-projects" role="tree"></div>
                    <div class="finder-empty" id="finder-project-empty" hidden>
                      No projects yet. Use the + button to add one.
                    </div>
                  </section>
                  <section class="finder-column" data-level="epic" aria-label="Epics">
                    <header class="finder-column-header">
                      <button class="finder-column-back" data-target-level="0" aria-label="Back to projects">
                        <i class="fas fa-angle-left"></i>
                      </button>
                      <span class="finder-column-title" id="finder-epic-heading">Epics</span>
                      <span class="finder-column-meta" id="finder-epic-count"></span>
                      <button class="finder-column-action" id="finder-add-epic" title="New epic">
                        <i class="fas fa-plus"></i>
                      </button>
                    </header>
                    <div class="finder-column-body" id="finder-column-epics" role="tree"></div>
                    <div class="finder-empty" id="finder-epic-empty" hidden>
                      Select a project to browse its epics.
                    </div>
                  </section>
                  <section class="finder-column" data-level="ticket" aria-label="Tickets">
                    <header class="finder-column-header">
                      <button class="finder-column-back" data-target-level="1" aria-label="Back to epics">
                        <i class="fas fa-angle-left"></i>
                      </button>
                      <span class="finder-column-title" id="finder-ticket-heading">Tickets</span>
                      <span class="finder-column-meta" id="finder-ticket-count"></span>
                      <button class="finder-column-action" id="finder-add-ticket" title="New ticket">
                        <i class="fas fa-plus"></i>
                      </button>
                    </header>
                    <div class="finder-column-body" id="finder-column-tickets" role="tree"></div>
                    <div class="finder-empty" id="finder-ticket-empty" hidden>
                      Select an epic to see its tickets.
                    </div>
                  </section>
                  <section class="finder-column finder-column--detail" data-level="detail" aria-label="Ticket detail">
                    <header class="finder-column-header">
                      <button class="finder-column-back" data-target-level="2" aria-label="Back to tickets">
                        <i class="fas fa-angle-left"></i>
                      </button>
                      <span class="finder-column-title" id="finder-detail-heading">Ticket Details</span>
                    </header>
                    <div class="finder-column-body finder-detail-body" id="finder-column-detail"></div>
                    <div class="finder-empty" id="finder-detail-empty" hidden>
                      Select a ticket to view its details.
                    </div>
                  </section>
                </div>
              </div>
            </div>
          </div>

          <div
            id="pagination-controls"
            class="pagination-controls"
            style="display: none"
          >
            <button id="prev-page">&laquo; Previous</button>
            <span id="page-info"></span>
            <input
              type="number"
              id="page-jump-input"
              min="1"
              placeholder="Page..."
            />
            <button id="page-jump-btn">Go</button>
            <button id="next-page">Next &raquo;</button>
          </div>

        </main>
      </div>
    </div>
    </div>

    <div
      id="shortcut-overlay"
      class="shortcut-overlay"
      role="dialog"
      aria-modal="true"
      aria-labelledby="shortcut-title"
      aria-hidden="true"
      style="display: none"
    >
      <div class="shortcut-modal">
        <div class="shortcut-modal-header">
          <h2 id="shortcut-title">Keyboard Shortcuts</h2>
          <button
            id="shortcut-close"
            class="shortcut-close"
            type="button"
            aria-label="Close"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="shortcut-modal-body">
          <p class="shortcut-intro">
            Speed up your workflow with these handy shortcuts.
          </p>
          <ul class="shortcut-list">
            <li>
              <span class="shortcut-keys">&#8984; / Alt + A</span>
              <span class="shortcut-desc">Add quick task</span>
            </li>
            <li>
              <span class="shortcut-keys">&#8984; / Alt + &#8595;</span>
              <span class="shortcut-desc">Open shortcuts guide</span>
            </li>
            <li>
              <span class="shortcut-keys">Ctrl + F</span>
              <span class="shortcut-desc">Search tickets</span>
            </li>
            <li>
              <span class="shortcut-keys">Esc</span>
              <span class="shortcut-desc">Close dialogs or guides</span>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <div
      id="ticket-search-overlay"
      class="ticket-search-overlay"
      role="dialog"
      aria-modal="true"
      aria-labelledby="ticket-search-title"
      aria-hidden="true"
      style="display: none"
    >
      <div class="ticket-search-modal">
        <div class="ticket-search-modal-header">
          <h2 id="ticket-search-title" class="sr-only">Search Tickets</h2>
          <i class="fas fa-search"></i>
          <input
            type="search"
            id="ticket-search-input"
            class="ticket-search-input"
            placeholder="Search tickets by title, description, or ID..."
            autocomplete="off"
          />
          <button
            id="ticket-search-close"
            class="ticket-search-close"
            type="button"
            aria-label="Close search"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="ticket-search-results-container" role="listbox">
          <div id="ticket-search-empty" class="ticket-search-empty">
            Start typing to search tickets...
          </div>
          <ul id="ticket-search-results" class="ticket-search-results"></ul>
        </div>
        <div class="ticket-search-hint">
          Press Enter to open, use arrow keys to navigate, Esc to close.
        </div>
      </div>
    </div>

    <div
      id="project-search-overlay"
      class="project-search-overlay"
      role="dialog"
      aria-modal="true"
      aria-labelledby="project-search-title"
      aria-hidden="true"
      style="display: none"
    >
      <div class="project-search-modal">
        <div class="project-search-modal-header">
          <h2 id="project-search-title" class="sr-only">Search Projects</h2>
          <i class="fas fa-search"></i>
          <input
            type="search"
            id="project-search-input"
            class="project-search-input"
            placeholder="Search projects by name..."
            autocomplete="off"
          />
          <button
            id="project-search-close"
            class="project-search-close"
            type="button"
            aria-label="Close search"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="project-search-results-container" role="listbox">
          <div id="project-search-empty" class="project-search-empty">
            Start typing to search projects...
          </div>
          <ul id="project-search-results" class="project-search-results"></ul>
        </div>
        <div class="project-search-hint">
          Press Enter to select, use arrow keys to navigate, Esc to close.
        </div>
      </div>
    </div>

    <div
      id="user-settings-overlay"
      class="user-settings-overlay"
      role="dialog"
      aria-modal="true"
      aria-labelledby="user-settings-title"
      aria-hidden="true"
      style="display: none"
    >
      <div class="user-settings-modal">
        <div class="user-settings-header">
          <div class="user-settings-header-text">
            <h2 id="user-settings-title">Account Settings</h2>
            <p id="user-settings-email" class="user-settings-email"></p>
          </div>
          <button
            id="user-settings-close"
            class="user-settings-close"
            type="button"
            aria-label="Close settings"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="user-settings-body">
          <dl class="user-settings-list">
            <div class="user-settings-item">
              <dt>Name</dt>
              <dd id="user-settings-name"></dd>
            </div>
            <div class="user-settings-item">
              <dt>Role</dt>
              <dd id="user-settings-role"></dd>
            </div>
            <div class="user-settings-item">
              <dt>Mode</dt>
              <dd id="user-settings-mode"></dd>
            </div>
            <div class="user-settings-item">
              <dt>Email</dt>
              <dd id="user-settings-email-value"></dd>
            </div>
            <div class="user-settings-item">
              <dt>Discord</dt>
              <dd id="user-settings-discord"></dd>
            </div>
          </dl>
        </div>
      </div>
    </div>

    <div id="logout-overlay" class="logout-overlay" style="display: none">
      <div class="spinner"></div>
      <p>Logging out...</p>
    </div>
    <div id="quick-add-overlay" class="quick-add-overlay" style="display: none">
      <div class="quick-add-panel" role="dialog" aria-modal="true" aria-labelledby="quick-add-title">
        <div class="quick-add-header">
          <span id="quick-add-title">Quick Add Ticket</span>
          <button id="quick-add-close" class="quick-add-close" type="button" aria-label="Close">&times;</button>
        </div>
        <div class="quick-add-editor-container">
          <div
            id="quick-add-editor"
            class="quick-add-editor"
            contenteditable="true"
            role="textbox"
            aria-multiline="true"
            spellcheck="false"
            data-placeholder="Describe the ticket. Use / to change details."
          ></div>
          <div id="quick-add-command-list" class="quick-add-command-list" role="listbox" aria-label="Quick add commands"></div>
          <div id="quick-add-value-panel" class="quick-add-value-panel" role="listbox" aria-label="Command values"></div>
        </div>
        <div id="quick-add-summary" class="quick-add-summary"></div>
        <div id="quick-add-error" class="quick-add-error" role="alert"></div>
        <div class="quick-add-hint">Press Ctrl+Enter (Cmd+Enter on Mac) to create &bull; Esc to cancel &bull; Alt+A or Cmd+A to open</div>
      </div>
    </div>
    <div id="bulk-update-modal" class="modal-overlay" style="display: none">
      <div class="modal-content" style="max-width: 800px">
        <div class="modal-header">
          <h2>Bulk Update Selected Tickets</h2>
          <button class="close-button">&times;</button>
        </div>
        <div class="modal-body">
          <p>
            Only fill in the fields you want to update. Leave fields blank to
            keep current values.
          </p>
          <div class="detail-grid" style="margin-top: 1.5rem">
            <div class="detail-field">
              <label>Project</label>
              <div id="bulk-update-project-container"></div>
            </div>
            <div class="detail-field">
              <label>Epic</label
              ><input
                type="text"
                id="bulk-update-epic"
                class="inline-editor"
                list="epic-datalist-bulk"
              />
            </div>
            <div class="detail-field">
            <div class="detail-field">
              <label>Requested By</label
              ><select
                id="bulk-update-requestedBy"
                class="inline-editor"
              ></select>
            </div>
            <div class="detail-field">
              <label>Status</label
              ><select id="bulk-update-status" class="inline-editor"></select>
            </div>
            <div class="detail-field">
              <label>Priority</label
              ><select id="bulk-update-priority" class="inline-editor"></select>
            </div>
          </div>
          <datalist id="epic-datalist-bulk"></datalist>
        </div>
        <div class="modal-footer">
          <button id="confirm-bulk-update-btn" class="save-btn">
            Update Tickets</button
          ><button class="cancel-btn">Cancel</button>
        </div>
      </div>
    </div>

    <div id="subtask-confirm-modal" class="modal-overlay" style="display: none">
      <div class="modal-content" style="max-width: 520px">
        <div class="modal-header"><h2>Incomplete Subtasks Detected</h2></div>
        <div class="modal-body">
          <p
            id="subtask-confirm-message"
            style="line-height: 1.6; font-size: 1rem"
          ></p>
        </div>
        <div class="modal-footer">
          <button class="cancel-btn" id="subtask-confirm-no">
            No, Go Back
          </button>
          <button class="save-btn" id="subtask-confirm-yes">
            Yes, Auto-Resolve
          </button>
        </div>
      </div>
    </div>

    <div id="new-epic-modal" class="modal-overlay" style="display: none">
      <div class="modal-content" style="max-width: 500px">
        <div class="modal-header">
          <h2 id="new-epic-modal-title">Create New Epic</h2>
        </div>
        <div class="modal-body">
          <p style="margin-bottom: 1rem">
            Enter a name for the new epic. You will then be prompted to add the
            first task within the epic.
          </p>
          <input
            type="text"
            id="new-epic-name-input"
            class="inline-editor"
            placeholder="Epic Name..."
          />
        </div>
        <div class="modal-footer">
          <button id="cancel-new-epic" class="cancel-btn">Cancel</button>
          <button id="submit-new-epic" class="save-btn">
            Create & Add Task
          </button>
        </div>
      </div>
    </div>

    <div id="project-detail-modal" class="modal-overlay" style="display: none">
      <div class="modal-content" style="max-width: 1200px; padding: 0">
        <button
          class="close-button modal-close-btn"
          style="top: 1rem; right: 1.5rem; z-index: 10"
        >
          &times;
        </button>
        <div
          id="project-detail-modal-body"
          class="modal-body"
          style="display: flex; width: 100%; padding: 0; overflow: hidden"
        >
          <div
            class="ticket-main-content"
            style="background-color: var(--surface-color)"
          >
            <textarea
              id="edit-project-name"
              class="modal-title-textarea"
              placeholder="Project Name..."
            ></textarea>
            <h4 class="modal-section-label">Description</h4>
            <textarea
              id="edit-project-description"
              class="modal-description-textarea"
              placeholder="Add a description..."
            ></textarea>
          </div>

          <div class="ticket-details-sidebar">
            <div class="sidebar-section">
              <h4>Properties</h4>
              <div class="sidebar-property-editable">
                <label class="prop-label">Project Owner</label>
                <div id="edit-project-owner-container"></div>
              </div>
              <div class="sidebar-property-editable">
                <label class="prop-label">Priority</label
                ><select
                  id="edit-project-priority"
                  class="inline-editor"
                  style="width: 100%"
                >
                  <option>High</option>
                  <option>Medium</option>
                  <option>Low</option>
                </select>
              </div>
              <div class="sidebar-property-editable">
                <label class="prop-label">Collaborators</label>
                <div id="edit-project-collaborators-container"></div>
              </div>
              <div class="sidebar-property-editable">
                <label class="prop-label">Attachment URL</label
                ><input
                  type="url"
                  id="edit-project-attachment"
                  class="inline-editor"
                  style="width: 100%"
                />
              </div>
            </div>
            <div class="sidebar-section">
              <h4>Dates</h4>
              <div class="sidebar-property-editable">
                <label class="prop-label">Start Date</label
                ><input
                  type="date"
                  id="edit-project-start-date"
                  class="inline-editor"
                  style="width: 100%"
                />
              </div>
              <div class="sidebar-property-editable">
                <label class="prop-label">Est. Completion Date</label
                ><input
                  type="date"
                  id="edit-project-est-completed-date"
                  class="inline-editor"
                  style="width: 100%"
                />
              </div>
            </div>
            <div
              class="sidebar-section"
              style="margin-top: auto; padding-top: 1rem"
            >
              <button
                id="save-project-details-btn"
                class="save-btn"
                style="width: 100%"
              >
                Save Changes
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="unsaved-changes-modal" class="modal-overlay" style="display: none">
      <div class="modal-content" style="max-width: 480px">
        <div class="modal-header">
          <h2 id="unsaved-modal-title">Unsaved Changes</h2>
        </div>
        <div class="modal-body">
          <p id="unsaved-modal-message" style="line-height: 1.6">
            You have unsaved changes. Are you sure you want to discard them?
          </p>
        </div>
        <div class="modal-footer">
          <button id="unsaved-keep-editing-btn" class="cancel-btn">
            Keep Editing
          </button>
          <button
            id="unsaved-discard-btn"
            class="action-btn"
            style="
              background-color: var(--danger-color);
              border-color: var(--danger-color);
            "
          >
            Discard
          </button>
        </div>
      </div>
    </div>
    <div id="unsaved-date-modal" class="modal-overlay" style="display: none">
      <div class="modal-content" style="max-width: 550px">
        <div class="modal-header">
          <h2>Unsaved Date Changes</h2>
        </div>
        <div class="modal-body">
          <p>
            You have the following unsaved date changes. Do you want to apply
            them before closing?
          </p>
          <ul
            id="unsaved-changes-list"
            style="
              margin-top: 1rem;
              list-style-position: inside;
              padding-left: 1rem;
              background-color: var(--row-alt-color);
              border: 1px solid var(--border-color);
              border-radius: 8px;
              padding: 1rem;
            "
          ></ul>
        </div>
        <div class="modal-footer">
          <button id="unsaved-date-no" class="cancel-btn">
            No, Discard Changes
          </button>
          <button id="unsaved-date-yes" class="save-btn">
            Yes, Apply Changes
          </button>
        </div>
      </div>
    </div>
    <div id="assignee-modal" class="modal-overlay" style="display: none">
      <div class="modal-content" style="max-width: 400px">
        <div class="modal-header">
          <h2>Assign Tickets</h2>
          <button class="close-button">&times;</button>
        </div>
        <div class="modal-body">
          <p>Select an assignee:</p>
          <div
            class="editable-field-wrapper has-value"
            style="margin-top: 1rem"
          >
            <select
              id="assignee-select"
              class="inline-editor"
              style="
                width: 100%;
                border: 1px solid var(--border-color);
                background-color: var(--bg-color);
              "
            ></select>
          </div>
        </div>
        <div class="modal-footer">
          <button id="confirm-assign-btn" class="save-btn">Assign</button
          ><button class="cancel-btn">Cancel</button>
        </div>
      </div>
    </div>
    <div id="warning-modal" class="modal-overlay" style="display: none">
      <div class="modal-content" style="max-width: 500px">
        <div class="modal-header">
          <h2>Data Validation Warnings</h2>
          <button class="close-button">&times;</button>
        </div>
        <div id="warning-content" class="modal-body"></div>
      </div>
    </div>
    <div
      id="complete-confirm-modal"
      class="modal-overlay"
      style="display: none"
    >
      <div class="modal-content" style="max-width: 520px">
        <div class="modal-header">
          <h2>Complete Ticket from Open</h2>
          <button class="close-button" id="ccm-close">&times;</button>
        </div>
        <div class="modal-body">
          <p>
            Start Date &amp; Complete Date is in the same date — are you sure to
            continue?
          </p>
          <div
            id="ccm-adjust-wrapper"
            style="
              display: none;
              gap: 8px;
              align-items: center;
              margin: 0.5rem 0;
            "
          >
            <label for="ccm-date">Adjust Start Date:</label
            ><input type="date" id="ccm-date" class="inline-editor" />
          </div>
        </div>
        <div class="modal-footer">
          <button class="save-btn" id="ccm-yes">Yes</button
          ><button class="action-btn" id="ccm-adjust">Adjust Start Date</button
          ><button class="cancel-btn" id="ccm-no">No</button>
        </div>
      </div>
    </div>
    <div
      id="bulk-start-adjust-modal"
      class="modal-overlay"
      style="display: none"
    >
      <div class="modal-content" style="max-width: 720px">
        <div class="modal-header">
          <h2>Complete From Open – Per Ticket</h2>
          <button class="close-button" id="bsam-close">&times;</button>
        </div>
        <div class="modal-body">
          <p style="margin-bottom: 0.75rem">
            Some tickets are moving from <strong>Open</strong> to
            <strong>Completed</strong>. Choose an action for each:
          </p>
          <div
            id="bsam-list"
            style="
              display: grid;
              grid-template-columns: 1fr;
              gap: 10px;
              max-height: 50vh;
              overflow: auto;
            "
          ></div>
        </div>
        <div class="modal-footer">
          <button class="save-btn" id="bsam-apply">Apply</button
          ><button class="cancel-btn" id="bsam-cancel">Cancel</button>
        </div>
      </div>
    </div>

    <div
      id="reconcile-create-ticket-modal"
      class="modal-overlay"
      style="display: none"
    >
      <div class="modal-content" style="max-width: 900px">
        <div class="modal-header">
          <h2><i class="fas fa-magic"></i> Create Ticket from Time Entry</h2>
          <button class="close-button modal-close-btn">&times;</button>
        </div>
        <div class="modal-body">
          <div class="detail-grid" id="reconcile-create-ticket-form">
            <div class="detail-field" style="grid-column: 1 / -1">
              <label
                ><i class="fas fa-heading fa-fw"></i> Title
                <span class="required-indicator">(* required)</span></label
              >
              <input
                type="text"
                id="rct-title"
                class="inline-editor"
                required
              />
            </div>

            <div class="detail-field" style="grid-column: 1 / -1">
              <label><i class="fas fa-align-left fa-fw"></i> Description</label>
              <textarea
                id="rct-description"
                class="inline-editor"
                rows="3"
              ></textarea>
            </div>

            <div class="detail-field">
              <label
                ><i class="fas fa-calendar-plus fa-fw"></i> Created Date
                <span class="required-indicator">(* required)</span></label
              >
              <div class="date-input-wrapper">
                <input
                  type="date"
                  id="rct-createdAt"
                  class="inline-editor"
                  required
                />
                <span
                  id="rct-createdAt-display"
                  class="date-format-display"
                ></span>
              </div>
            </div>
            <div class="detail-field">
              <label><i class="fas fa-tag fa-fw"></i> Type</label>
              <select id="rct-type" class="inline-editor">
                <option value="Task">Task</option>
                <option value="Bug">Bug</option>
                <option value="Request">Request</option>
              </select>
            </div>

            <div class="detail-field">
              <label
                ><i class="fas fa-user-tag fa-fw"></i> Requested By
                <span class="required-indicator">(* required)</span></label
              >
              <div id="rct-requestedBy-container"></div>
            </div>
            <div class="detail-field">
              <label><i class="fas fa-user-check fa-fw"></i> Assignee</label>
              <div id="rct-assignee-container"></div>
            </div>

            <div class="detail-field">
              <label><i class="fas fa-flag fa-fw"></i> Status</label>
              <select id="rct-status" class="inline-editor">
                <option selected>Open</option>
                <option>In Progress</option>
                <option>On Hold</option>
                <option>Blocked</option>
                <option>Cancelled</option>
                <option>Rejected</option>
                <option>Completed</option>
              </select>
            </div>

            <div
              class="detail-field rct-conditional"
              id="rct-assignedAt-container"
              style="display: none"
            >
              <label
                ><i class="fas fa-calendar-check fa-fw"></i> Assigned Date
                <span class="required-indicator">(* required)</span></label
              >
              <div class="date-input-wrapper">
                <input type="date" id="rct-assignedAt" class="inline-editor" />
                <span
                  id="rct-assignedAt-display"
                  class="date-format-display"
                ></span>
              </div>
            </div>

            <div
              class="detail-field rct-conditional"
              id="rct-startedAt-container"
              style="display: none"
            >
              <label
                ><i class="fas fa-play-circle fa-fw"></i> Started Date
                <span class="required-indicator">(* required)</span></label
              >
              <div class="date-input-wrapper">
                <input type="date" id="rct-startedAt" class="inline-editor" />
                <span
                  id="rct-startedAt-display"
                  class="date-format-display"
                ></span>
              </div>
            </div>
            <div
              class="detail-field rct-conditional"
              id="rct-completedAt-container"
              style="display: none"
            >
              <label
                ><i class="fas fa-check-circle fa-fw"></i> Completed Date
                <span class="required-indicator">(* required)</span></label
              >
              <div class="date-input-wrapper">
                <input type="date" id="rct-completedAt" class="inline-editor" />
                <span
                  id="rct-completedAt-display"
                  class="date-format-display"
                ></span>
              </div>
            </div>
            <div
              class="detail-field rct-conditional"
              id="rct-reason-container"
              style="display: none; grid-column: 1 / -1"
            >
              <label
                ><i class="fas fa-comment-dots fa-fw"></i> Reason
                <span class="required-indicator">(* required)</span></label
              >
              <input
                type="text"
                id="rct-reason"
                class="inline-editor"
                placeholder="Reason for status change..."
              />
            </div>


            <div class="detail-field">
              <label><i class="fas fa-folder fa-fw"></i> Project</label>
              <div id="rct-project-container"></div>
            </div>
            <div class="detail-field">
              <label><i class="fas fa-bolt fa-fw"></i> Epic</label>
              <input
                type="text"
                id="rct-epic"
                class="inline-editor"
                list="epic-datalist-rct"
                placeholder="Type or select..."
              />
              <datalist id="epic-datalist-rct"></datalist>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button id="rct-submit-btn" class="save-btn">Create Ticket</button>
        </div>
      </div>
    </div>

    <input type="hidden" id="user-email" value="{{EMAIL}}" />
    <input type="hidden" id="user-name" value="{{NAME}}" />
    <input type="hidden" id="initial-mode" value="{{MODE}}" />
    <input type="hidden" id="user-role" value="{{ROLE}}" />
    <input type="hidden" id="script-url" value="{{SCRIPT_URL}}" />
    <input type="hidden" id="app-version" value="{{APP_VERSION}}" />
    <input type="hidden" id="app-build-time" value="{{APP_BUILD_TIME}}" />

    <input type="hidden" id="url-ticket-number" value="{{TICKET_NUMBER}}" />
    <input type="hidden" id="url-initial-view" value="{{INITIAL_VIEW}}" />

    <input type="hidden" id="favicon-url" value="{{FAVICON_URL}}" />
